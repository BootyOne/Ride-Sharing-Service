# Ride-Sharing-Service

## Описание

Проект представляет собой службу для совместного использования автомобилей, позволяющую пользователям регистрироваться как водителями, так и пассажирами. Система предлагает возможности создания поездок, регистрации на уже созданные поездки, а также управления регионами и статусами поездок.

## Структура проекта

```
src/
│
├── auth/                # Аутентификация и управление пользователями
│   ├── models.py
│   ├── routers.py
│   ├── schemas.py
│   └── utils.py
│
├── database/            # Конфигурация и инициализация базы данных
│   ├── config.py
│   ├── database.py
│   └── init.py
│
├── drive/               # Управление поездками
│   ├── models.py
│   ├── routers.py
│   └── schemas.py
│
├── regions/             # Управление регионами
│   ├── models.py
│   ├── routers.py
│   ├── schemas.py
│   └── utils.py
│
└── main.py              # Основной файл приложения
└── config.py            # Конфигурация приложения
```

## Используемые технологии

* FastAPI
* Peewee для работы с базой данных PostgreSQL
* Peewee_migrate для миграций базы данных

## Основные функциональности

### Аутентификация и управление пользователями
* Регистрация новых пользователей
* Аутентификация существующих пользователей
* Обновление профиля пользователя
### Управление поездками
* Создание новой поездки
* Удаление существующей поездки
* Регистрация на поездку
* Отмена регистрации на поездку
### Управление регионами
* Добавление новых стран и городов
* Получение списка всех стран и городов
* Удаление стран и городов

## Архитектура
### База данных
В качестве базы данных используется PostgreSQL, а для работы с ней выбрана библиотека Peewee.

#### Таблицы:
* User: Таблица для хранения информации о пользователях. Включает такие поля как id, username, password_hash, is_active и др.
* Country: Таблица для хранения стран. Содержит id и name.
* City: Таблица для хранения городов. Содержит id, name, latitude, longitude и country_id (внешний ключ к таблице Country).
* TripsStatuses: Таблица для хранения статусов поездок. Содержит id и name.
* Trips: Таблица для хранения поездок. Содержит поля id, driver_id (внешний ключ к User), description, start_time, end_time, departure_country и другие.
* UserTrips: Таблица для хранения заявок на поездки от пользователей. Содержит поля id, trip_id (внешний ключ к Trips) и user_id (внешний ключ к User).

### Backend:

* auth: авторизация и аутентификация пользователей.
* regions: управление регионами и городами.
* drive: создание и управление поездками.


### Схемы
* UserUpdate: схема для обновления данных пользователя.
* TripCreate: схема для создания новой поездки.
* TripStatusCreate: схема для создания статуса поездки.
* RegionsRead, CityRead: схемы для чтения информации о регионах и городах.

## API документация
После запуска приложения API документацию можно найти по адресу http://localhost:8000/docs.

## Установка и запуск

### Установите необходимые пакеты:
Если вы ещё не установили Poetry, сделайте это сначала. Затем, находясь в корневой директории проекта, где расположен файл pyproject.toml, выполните:
```bash
poetry install
```
Это установит все зависимости, указанные в pyproject.toml.

### Создайте файл .env с настройками базы данных и ключами для шифрования.
Пример содержимого файла .env:
```bash
DB_USER=your_db_user
DB_PASSWORD=your_db_password
DB_HOST=localhost
DB_NAME=your_db_name
DB_PORT=5432
SECRET_KEY=your_secret_key
ALGORITHM=your_algorithm
```
### Примените миграции для создания структуры базы данных:
Сначала активируйте виртуальное окружение, созданное Poetry:
```bash
poetry shell
```
Затем примените миграции:
```bash
poetry run python src/database/init.py
```
### Запустите приложение:
```bash
poetry run  uvicorn src.main:app --host 127.0.0.1 --port 8000
```